a) I carried out two attacks in order to obtain the secret, each one exploiting a different vulnerability in the C code provided. In the first attack, I generated a new private key data0.priv, and from that a certificate data0.req, which I made with the name data.gov-of-caltopia.info/.neocal.info. Since the C code takes the CN to be whatever comes before the first forward slash found in the string argument, I formed the CN name by appending to "data.gov-of-caltopia.info" a forward slash, followed by the one ending I could use to create a certificate, ".neocal.info". This way I was able to generate a request that I could use to create a certificate, whose content I in turn saved in data0.x509. I used the sslsniff tools to install the certificate and private key and intercept HTTP requests. I also modified the Ruby script such that it would replace a "false" value for the "emergency_kill" field with a "true" value. I was thus able to activate the emergency kill command and gain access to the HTTP request containing the secret.
In my second attack, I exploited the second flaw in the C code by replacing the forward slash in the CN I had provided earlier with a null character. I wrote "data.gov-of-caltopia.info\0.neocal.info" to a .dat file that I passed in as an argument to the rewrite_cn script in order to change the CN name. Doing so again enabled me to obtain a spoofed certificate, which I installed using the sslsniff tools in order to intercept the HTTP request with the secret.

b) To protect against these attacks, gov-of-caltopia.info can use TLS or SSL, so that traffic is encrypted and eavesdroppers are not able to access plaintext requests.

c) To protect against these attacks, the governor can make sure that his software doesn't extract CN's by simply taking anything the segment that appears before the first forward slash or null character in the CN argument. These flaws in the software code can be fixed by comparing the length of the segment before the first forward slash or null character and the length of the entire string argument and only validating the common name if the two lengths are equal.

d) To protect against these attacks, budget-certs-r-us.biz can reject domain names with special characters in them so as to filter out domain names that have the potential to fool flawed certificate-verifying software like that which is on the governor's computer.